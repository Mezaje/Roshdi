<!-- /views/admin/articles_new.ejs (محدّث: رفع صورة + معاينة) -->
<%- include('layout_head', { title }); %>
<h2>إضافة مقال</h2>
<form method="post" action="/admin/articles" enctype="multipart/form-data">
  <label>العنوان</label>
  <input name="title" required />
  <div class="form-row">
    <div>
      <label>Slug (رابط فريد بالإنجليزية)</label>
      <input name="slug" required placeholder="arabic-meters" />
    </div>
    <div>
      <label>وسوم (مفصولة بفواصل)</label>
      <input name="tags" placeholder="نقد, كتابة…" />
    </div>
  </div>
  <label>مقتطف</label>
  <textarea name="excerpt" rows="3"></textarea>

  <label>صورة الغلاف (اختياري)</label>
  <input type="file" name="image" accept="image/*" onchange="previewImg(this,'pv2')" />
  <div id="pv2" class="mt-2"></div>

  <label>نص المقال</label>
  <textarea name="content" rows="12" required></textarea>
  <div class="form-row">
    <div>
      <label>تاريخ (اختياري)</label>
      <input name="createdAt" type="date" />
    </div>
  </div>
  <button class="btn" type="submit">حفظ</button>
</form>
<script>
function previewImg(inp, id){
  const el=document.getElementById(id); if(!inp.files||!inp.files[0]) return el.innerHTML='';
  const url=URL.createObjectURL(inp.files[0]); el.innerHTML=`<img src="${url}" alt="preview" class="round shadow" style="max-width:240px">`;
}
</script>
<%- include('layout_foot'); %>
